<!DOCTYPE html>
<html>

<head>
    <title>Test Duration Calculation Button</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <h1>Test Duration Calculation Button</h1>

    <p>
        <label for="route_duration">Duration (minutes):</label>
        <input type="number" id="route_duration" name="route_duration" value="" min="0" style="width: 100px;" />
        <button type="button" id="calculate-duration" style="margin-left: 10px;">Calculate</button>
    </p>

    <p>
        <label for="route_type">Route Type:</label>
        <select id="route_type" name="route_type">
            <option value="">Select Type</option>
            <option value="walking">Walking</option>
            <option value="cycling">Cycling</option>
            <option value="wheelchair">Wheelchair Accessible</option>
            <option value="children">Child-Friendly</option>
        </select>
    </p>

    <p>Route Distance: <span id="route-distance">2.5</span> km</p>

    <script>
        // Mock the functions needed for testing
        function calculateRouteLength() {
            return 2.5; // Mock 2.5 km route
        }

        function calculateEstimatedDuration(distanceKm, routeType) {
            if (!distanceKm || distanceKm <= 0) {
                return 0;
            }

            // Average speeds in km/h for different route types
            const speeds = {
                'walking': 4.5,      // Average walking speed
                'cycling': 15,       // Average cycling speed  
                'wheelchair': 3.5,   // Slower walking speed for wheelchair accessibility
                'children': 3.0      // Slower pace for child-friendly routes
            };

            // Default to walking speed if route type not specified or unknown
            const speed = speeds[routeType] || speeds['walking'];

            // Calculate duration in hours, then convert to minutes
            const durationHours = distanceKm / speed;
            const durationMinutes = Math.round(durationHours * 60);

            console.log(`Duration calculation: ${distanceKm.toFixed(2)}km at ${speed}km/h = ${durationMinutes} minutes (route type: ${routeType || 'default/walking'})`);

            return durationMinutes;
        }

        function updateEstimatedDuration() {
            const distance = calculateRouteLength();
            const routeTypeField = $("#route_type");
            const durationField = $("#route_duration");

            if (distance > 0 && routeTypeField.length && durationField.length) {
                const routeType = routeTypeField.val();
                const estimatedDuration = calculateEstimatedDuration(distance, routeType);

                // Update the duration field with the calculated value
                durationField.val(estimatedDuration);
                console.log(`Updated duration field to ${estimatedDuration} minutes`);
            }
        }

        // Manual duration calculation button
        $(document).on("click", "#calculate-duration", () => {
            updateEstimatedDuration();
        });
    </script>
</body>

</html>